wchar_t path[64];
swprintf_s(path, _countof(path), L"\\\\.\\PhysicalDrive%d", 0);
HANDLE hDrive = CreateFile(path, GENERIC_READ | GENERIC_WRITE,
    FILE_SHARE_READ | FILE_SHARE_WRITE, NULL,
    OPEN_EXISTING, 0, NULL);

# --- New Code Block --- 

ATA_PASS_THROUGH_EX inputBuffer;
inputBuffer.Length = sizeof(ATA_PASS_THROUGH_EX);
inputBuffer.AtaFlags = ATA_FLAGS_DATA_IN;
inputBuffer.DataTransferLength = 0;
inputBuffer.DataBufferOffset = 0;

UINT inputBufferSize = sizeof(ATA_PASS_THROUGH_EX);
int ioControlCode = IOCTL_ATA_PASS_THROUGH;
UINT bytesReturned = 0;
BYTE outputBuffer[512];
BOOL check = DeviceIoControl(hDrive, ioControlCode,
    &inputBuffer, inputBufferSize,
    outputBuffer, outputBufferSize,
    &bytesReturned,
    NULL
);