import dspy
from dotenv import load_dotenv
from google.genai.types import GenerateContentConfig, ThinkingConfig

load_dotenv()

config = GenerateContentConfig(
    thinking_config=ThinkingConfig(
        thinking_budget=0
    )
)

lm = dspy.LM("gemini/gemini-2.5-flash", cache=False, config=config, thinking_budget=0, reasoning=False)
dspy.configure(lm=lm, track_usage=True)

classifier = dspy.Predict(dspy.Signature("problem -> answer: float"))
res = classifier(problem="What's 9 + 10?")

if res.get_lm_usage()["gemini/gemini-2.5-flash"]["completion_tokens_details"] is not None:
    assert res.get_lm_usage()["gemini/gemini-2.5-flash"]["completion_tokens_details"]["reasoning_tokens"] == 0, "Reasoning is still turned on"