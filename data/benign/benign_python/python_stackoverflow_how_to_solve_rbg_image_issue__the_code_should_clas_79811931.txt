def make_model(num_classes):
    print("Building model...")
    data_augmentation = tf.keras.Sequential([
        tf.keras.layers.RandomFlip("horizontal"),
        tf.keras.layers.RandomRotation(0.08),
        tf.keras.layers.RandomZoom(0.08),
    ], name="data_augmentation")

    preprocess_input = tf.keras.applications.efficientnet.preprocess_input

    # Input layer (for RGB)
    inputs = tf.keras.Input(shape=IMG_SIZE + (3,))   # (224,224,3)
    x = data_augmentation(inputs)
    x = tf.keras.layers.Lambda(preprocess_input)(x)

    # Base model (expects RGB)
    base_model = tf.keras.applications.EfficientNetB0(
        include_top=False,
        weights="imagenet",
        input_shape=IMG_SIZE + (3,),  # (224,224,3)
        pooling="avg"
    )
    base_model.trainable = False

    x = base_model(x)
    x = tf.keras.layers.Dropout(0.3)(x)
    outputs = tf.keras.layers.Dense(num_classes, activation="softmax")(x)

    model = tf.keras.Model(inputs=inputs, outputs=outputs, name="efficientnetb0_dogbreeds")
    model.compile(
        optimizer=tf.keras.optimizers.Adam(learning_rate=BASE_LR),
        loss="sparse_categorical_crossentropy",
        metrics=[
            "sparse_categorical_accuracy",
            tf.keras.metrics.TopKCategoricalAccuracy(k=5, name="top-5-accuracy")
        ]
    )
    model.summary()
    return model, base_model;